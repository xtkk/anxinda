
# 安心达项目需求设计文档

本软件是给斯柯达为专属医院针对VIP患者提供预约订车服务所使用的软件，包括司机端小程序、患者端小程序、后台管理系统。


## 版本信息

版本号 | 修订日期 | 修改内容
--- | --- | ---
1.0 | 2019-06-11 | 1.0版功能需求文档


## 本软件(v1.0)不包含的功能

- 用户注册
- 线上支付
- 实时显示司机位置


## 患者端小程序功能模块详细描述

### 登录模块
首先通过`微信授权`尝试获取用户的手机号: <br>
若获取成功，则检查手机号是否位于给定名单中，以此判断是否登录成功。若不在名单中，则弹窗告知用户非服务对象<br>
若获取失败，则提供登录界面让用户登录，登录采用 `手机号+短信验证码` 的方式<br>

### 首页
首页主要包含一个地图模块，提供上车地点与下车地点的选择功能，
下面有2个输入框和一个按钮，可手动输入地址

功能点说明：
1. 地图组件，可放大缩小，默认以用户当前所在位置为中心，并且可以让用户移动地点和手动搜索两种形式选择
2. 目的地固定为某医院，不可修改
3. 点击按钮，跳转到预约信息填写页面

### 预约信息填写页面
该页面主要是填写预约时间和乘车人信息等，下面有一个“确认行程”按钮

功能点说明：
1. 乘车日期为4小时后的时间
2. 乘车人姓名
3. 乘车人电话
4. 是否选择增值服务费(目前为固定费用)
5. 备注
6. 订单费用，由上一步选择的上车点与下车点形成的总里程数决定，具体算法见[附录1-价格算法](#附录1)
7. 可用车辆数，由后台调度系统决定，如果为0，则不可进行下一步。
8. 点击“确认行程”按钮，生成行程单并跳转到行程单详情页面(此时，该订单为`预约中`状态)，由后台系统为该订单调度车辆。

### 行程单详情页面
该页面主要显示行程信息，包括乘车人信息，车辆信息，订单信息

订单信息包括：订单号、订单状态、订单价格、订单生成时间、预约成功时间、订单结束时间和订单距离等<br>
> 订单状态见[附录2中的用户端订单状态](#用户端显示的订单状态)<br>
> 关于时间：有则显示，没有则不显示<br>

如果为预约成功，则同时显示车辆信息<br>
如果为预约失败，则显示失败原因，比如无可用车辆等<br>
预约成功之后，状态随司机的动作而进行变化

车辆信息包括：司机姓名、电话、车牌号码和型号颜色等

### 行程列表页面
显示该订车人下的所有订单<br>
每个订单要显示的内容：<br>
订单号、订单状态、订单预约时间、上车地点、医院名称<br>
订单状态见[附录2中的用户端订单状态](#用户端显示的订单状态)<br>

### 客服静态页面


## 司机端小程序功能模块详细描述

### 打卡页面
进入打卡页面，选择上班打卡，则该司机即进入当天可调度状态，该页面只可打开一次，之后默认进入订单列表页面

### 订单列表页面
该页面可查看分配给该司机的订单列表，以预约时间排序，最近的显示最靠前<br>
订单要显示的信息包括：<br>
订单号、出发地、预约时间、乘客姓名、乘客手机号、订单状态(已完成、进行中、待处理)<br>

> 订单状态见[附录2中的司机端订单状态](#司机端显示的订单状态)<br>

### 订单详情页面
显示该订单的信息信息，包括：<br>
乘车人的姓名、手机号、上车地点、预约时间<br>
订车人姓名、手机号及备注<br>

下面有开始行程按钮<br>
司机点击该按钮，会自动触发短信通知，告知乘车人司机已出发，告知医院等待乘车到达<br>
同时该订单进入“进行中”的状态

开始行程之后，该按钮变为“行程结束”<br>
司机将乘客送至目的地之后，司机需手动触发行程结束动作，会自动通知乘客和医院。<br>
同时该订单变为“已完成”状态


## 后台管理系统功能模块详细描述

### 司机管理
列出所有司机信息，包括姓名、电话、当天是否打卡

### 车辆管理
列出所有可用车辆，包括车牌号码、颜色、车型等等

### 待调度订单列表
显示所有预约中的订单

### 调度页面
该页面为指定的订单进行调度，可为该订单分配司机和车辆，分配之后该订单即进入“预约成功”状态<br>
如果可用司机或车辆为0，则可以修改该订单为“预约失败”

### 订单列表页面
显示所有的订单，顶部的筛选条件可以提供不同的筛选条件，包括已完成订单、进行中订单、待预约订单等<br>


## 附录1
### 价格算法：

> 以下数值仅为演示

按照里程数区间进行计价：

里程区间(单位:公里)|价格(单位:元)
---|---
0 ~ 10 | 30
10 ~ 20 | 50
20 ~ 30 | 80


## 附录2

### 用户端显示的订单状态
状态 | 备注
--- | ---
预约中 | 等待后台调度
预约成功 | 调度成功且司机未出发
预约失败 | 无司机或车辆
服务中 | 预约成功且司机已出发
服务结束 | 司机已送至目的地且已收款成功

### 司机端显示的订单状态
状态 | 备注
--- | ---
待处理 | 等待司机处理
进行中 | 司机已出发
已完成 | 司机已将乘客送至目的地